import{d as I,r as c,u as O,g as j,s as M,t as H,w,a as J,c as _,b as u,e as i,f as k,h as R,n as S,i as C,j as K,o as d,_ as L,k as Q,l as D,m as E,p as b,q as X,v as N,x as f,y as F,z as Y,A,B as W,C as q,F as Z,D as V,E as ee,G as ae,H as se,I as te}from"./index-65df3919.js";import{L as z}from"./LoadingSpinner-67d4de55.js";const le={class:"box"},re={key:0,class:"infoAboutPlayers"},ne={class:"box"},oe=["disabled"],ue={key:1,class:"containerCardButtons"},ce={class:"circle"},ie=I({__name:"TheCardComponent",props:{header:{},currentUser:{},video:{},desc:{},color:{},routeTo:{},maxPlayers:{}},emits:["click-lobby","click-accept","click-cancel"],setup(h,{emit:l}){const t=h,m=c("Go to Lobby"),o=c("Exit Lobby"),U=c("Accept"),y=c("Cancel"),v=c("Waiting for approval"),T=O(),P=j(),{duel:g,gems:a,reflex:r}=M(P),{currentUser:x}=H(t),e=c({id:t.header,status:"Free",players:[]});return w(()=>g.value.players,s=>{e.value.id==="Duel"&&(e.value.players=s,s.length===0?e.value.status="Free":s.length===t.maxPlayers?e.value.status="Busy":e.value.status="Lobby",s.find(n=>!n.readyToGame)||T.push("/feed/duel-game"))}),w(()=>a.value.players,s=>{e.value.id==="Gems"&&(e.value.players=s,s.length===0?e.value.status="Free":s.length===t.maxPlayers?e.value.status="Busy":e.value.status="Lobby")}),w(()=>r.value.players,s=>{e.value.id==="Reflex"&&(e.value.players=s,s.length===0?e.value.status="Free":s.length===t.maxPlayers?e.value.status="Busy":e.value.status="Lobby")}),(s,n)=>{var B;const p=J("ion-icon");return d(),_("div",{class:S(["card"]),style:K(`${s.color}`)},[u("div",le,[e.value.players.length===t.maxPlayers&&s.maxPlayers!==0?(d(),_("div",re,[u("p",null,i(v.value),1),u("div",null,[u("p",null,i(e.value.players[0].displayName||e.value.players[0].email)+i(": "),1),e.value.players[0].readyToGame?(d(),k(p,{key:1,name:"thumbs-up-sharp",style:"margin-left: 10px;"})):(d(),k(z,{key:0,small:"",style:"margin-left: 10px;"}))]),u("div",null,[u("p",null,i(e.value.players[1].displayName||e.value.players[1].email)+i(": "),1),e.value.players[1].readyToGame?(d(),k(p,{key:1,name:"thumbs-up-sharp",style:"margin-left: 10px;"})):(d(),k(z,{key:0,small:"",style:"margin-left: 10px;"}))])])):R("",!0)]),u("div",ne,[u("h2",null,i(e.value.id),1),u("p",null,i(s.desc),1),e.value.players.length<t.maxPlayers||s.maxPlayers===0?(d(),_("button",{key:0,disabled:s.maxPlayers===0,class:S(["cardButton",e.value.players.find(G=>G.uid===C(x).uid)?"cardButtonLobby":""]),onClick:n[0]||(n[0]=()=>l("click-lobby"))},i(s.maxPlayers===0?"In progress":e.value.players.find(G=>G.uid===C(x).uid)?o.value:m.value),11,oe)):(B=e.value.players.find(G=>G.uid===C(x).uid))!=null&&B.readyToGame?R("",!0):(d(),_("div",ue,[u("button",{class:S(["cardButton"]),onClick:n[1]||(n[1]=()=>l("click-accept"))},i(U.value),1),u("button",{class:S(["cardButton"]),onClick:n[2]||(n[2]=()=>l("click-cancel"))},i(y.value),1)]))]),u("div",ce,[u("h2",null,i(t.header),1),u("h3",null,i(s.maxPlayers===0?"IN PROGRESS":e.value.status),1),u("p",null,i(s.maxPlayers===0?"IN PROGRESS":`${e.value.players.length}/${s.maxPlayers}`),1)])],4)}}}),$=L(ie,[["__scopeId","data-v-de1e0a85"]]),de={class:"gameContainer"},me=I({__name:"TheGame",props:{header:{},currentUser:{}},setup(h){const l=h,{colors:t}=Q("indicatorNavi"),m=j(),{duel:o}=M(m),U=D(E,"gameStatus"),y=b(U,"Duel"),v=D(E,"status");X(async()=>{await m.subFirebaseConnect()});async function T(){if(o.value.players.find(a=>a.uid===l.currentUser.uid)){await f(b(v,l.currentUser.uid),{game:"",readyToGame:!1,online:"online",timestamp:F()});const a=o.value.players.filter(r=>r.uid!==l.currentUser.uid?r:null);await f(y,{players:a})}else await f(b(v,l.currentUser.uid),{game:"Duel",readyToGame:!1,online:"online",timestamp:F()}),await f(y,{players:Y({...l.currentUser,game:"Duel",readyToGame:!1})})}async function P(){if(o.value.players.length===2&&o.value.players.find(a=>a.uid===l.currentUser.uid)){await f(b(v,l.currentUser.uid),{readyToGame:!0});const a=o.value.players.map(r=>r.uid===l.currentUser.uid?{...r,readyToGame:!0}:{...r});await f(y,{players:a})}}async function g(){if(o.value.players.length===2&&o.value.players.find(a=>a.uid===l.currentUser.uid)){o.value.players.forEach(async({uid:r})=>{r===l.currentUser.uid?await f(b(v,r),{game:"",readyToGame:!1}):await f(b(v,r),{readyToGame:!1})});const a=o.value.players.filter(r=>r.uid!==l.currentUser.uid?r:null).map(r=>({...r,readyToGame:!1}));await f(y,{players:a})}}return(a,r)=>(d(),_("section",de,[N($,{header:"Duel",currentUser:a.currentUser,desc:"A board game inspired by a strategy game called '7 Wonders of the World'",video:"Video soon!",color:C(t)[0],"route-to":"/feed/duel-game","max-players":2,onClickLobby:T,onClickAccept:P,onClickCancel:g},null,8,["currentUser","color"]),N($,{header:"Gems",currentUser:a.currentUser,desc:"IN PROGRESS",video:"'IN PROGRESS - Video soon!'",color:C(t)[1],"route-to":"/feed/splendor-game","max-players":0},null,8,["currentUser","color"]),N($,{header:"Reflex",currentUser:a.currentUser,desc:"IN PROGRESS",video:"'IN PROGRESS - Video soon!'",color:C(t)[2],"route-to":"/feed/reflex-game","max-players":0},null,8,["currentUser","color"])]))}}),pe=L(me,[["__scopeId","data-v-f26aef4b"]]),ye=I({__name:"TheSettings",props:{header:{}},setup(h){const l=h,t=c(!1);let m;return A(()=>{m=W(),q(m,o=>{o?t.value=!0:t.value=!1})}),(o,U)=>(d(),_("h2",null,i(l.header),1))}}),ve=L(ye,[["__scopeId","data-v-9a33a386"]]),fe=I({__name:"TheLogout",props:{header:{}},setup(h){const l=h,t=O();let m;A(()=>{m=W()});const o=()=>{V(m).then(()=>{t.push("/")})};return(U,y)=>(d(),_(Z,null,[u("h2",null,i(l.header),1),u("button",{class:S("customButton"),onClick:o},"log out")],64))}}),he=L(fe,[["__scopeId","data-v-4b372c8a"]]),ge={class:"header"},be={class:"wrapper"},_e=I({__name:"FeedPanel",setup(h){const l=c("Feed Panel"),t=c("Games"),m=c("Settings"),o=c("log Out"),U=c("game-controller-outline"),y=c("settings-outline"),v=c("log-out-outline"),T=O(),P=D(E,"status"),g=c({}),a=c(t.value),r=c([{name:`${t.value}`,ionIconClass:U.value,to:"/feed/games"},{name:`${m.value}`,ionIconClass:y.value,to:"/feed/settings"},{name:`${o.value}`,ionIconClass:v.value,to:"/feed/logout"}]),x=n=>a.value=n,e=c(["--clr:#2196f3;","--clr:#008a1b;","--clr:#dc1dff;","--clr:#f3218b;","--clr:#d56f1d;"]);ee("indicatorNavi",{activeLink:a,routes:r,updateActiveLink:x,colors:e}),A(async()=>{await s().then(async n=>{g.value={uid:n.uid,email:n.email||"",displayName:n.displayName||""};const p=await ae(b(P,n.uid));p.exists()?console.log("%c status user -> ","background: #222; color: #bada55",p.data()):await se(b(P,n.uid),{game:"",readyToGame:!1,online:"online",timestamp:F()})}),r.value.find(({name:n,to:p})=>p===T.currentRoute.value.path?(a.value=n,!0):!1)});const s=()=>new Promise((n,p)=>{const B=q(W(),G=>{B(),n(G)},p)});return(n,p)=>(d(),_("main",null,[u("header",ge,[u("h1",null,i(l.value),1)]),u("section",be,[a.value===t.value?(d(),k(pe,{key:0,header:t.value,currentUser:g.value},null,8,["header","currentUser"])):R("",!0),a.value===m.value?(d(),k(ve,{key:1,header:m.value,currentUser:g.value},null,8,["header","currentUser"])):R("",!0),a.value===o.value?(d(),k(he,{key:2,header:o.value,currentUser:g.value},null,8,["header","currentUser"])):R("",!0)]),N(te)]))}}),ke=L(_e,[["__scopeId","data-v-781a4585"]]);export{ke as default};
