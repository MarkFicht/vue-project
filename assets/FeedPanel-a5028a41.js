import{d as B,r,s as q,t as Y,w as P,c as U,a as o,b as i,n as E,u as p,e as L,f as Z,o as m,_ as D,g as H,i as V,h as $,j as A,k as h,l as ee,m as K,p as ae,q as se,v as x,x as N,y as f,z as O,A as te,B as W,C as Q,D as le,F as ne,E as re,G as oe,H as ue,I as ie,J as ce}from"./index-85539224.js";import{g as X,b as de,d as pe,L as M}from"./debounce-5e97aefb.js";const me={class:"box"},ye={class:"box"},ve=["disabled"],fe={class:"circle"},_e=B({__name:"TheCardComponent",props:{header:{},currentUser:{},video:{},desc:{},color:{},routeTo:{},maxPlayers:{}},emits:["click-lobby"],setup(b,{emit:n}){const u=b,d=r("Go to Lobby"),y=r("Exit Lobby"),T=X(),{duel:S,gems:w,reflex:_}=q(T),{currentUser:a}=Y(u),e=r({id:u.header,status:"Free",players:[]});return P(()=>S.value.players,s=>{e.value.id==="Duel"&&(e.value.players=s,s.length===0?e.value.status="Free":s.length===u.maxPlayers?e.value.status="Busy":e.value.status="Lobby")}),P(()=>w.value.players,s=>{e.value.id==="Gems"&&(e.value.players=s,s.length===0?e.value.status="Free":s.length===u.maxPlayers?e.value.status="Busy":e.value.status="Lobby")}),P(()=>_.value.players,s=>{e.value.id==="Reflex"&&(e.value.players=s,s.length===0?e.value.status="Free":s.length===u.maxPlayers?e.value.status="Busy":e.value.status="Lobby")}),(s,v)=>(m(),U("div",{class:E(["card"]),style:Z(`${s.color}`)},[o("div",me,i(s.video),1),o("div",ye,[o("h2",null,i(e.value.id),1),o("p",null,i(s.desc),1),e.value.players.length<u.maxPlayers||s.maxPlayers===0?(m(),U("button",{key:0,disabled:s.maxPlayers===0,class:E(["cardButton",e.value.players.find(G=>G.uid===p(a).uid)?"cardButtonLobby":""]),onClick:v[0]||(v[0]=()=>n("click-lobby"))},i(s.maxPlayers===0?"Soon":e.value.players.find(G=>G.uid===p(a).uid)?y.value:d.value),11,ve)):L("",!0)]),o("div",fe,[o("h2",null,i(u.header),1),o("p",null,i(s.maxPlayers===0?"-":e.value.status),1),o("p",null,i(s.maxPlayers===0?"-":`${e.value.players.length}/${s.maxPlayers}`),1)])],4))}});const z=D(_e,[["__scopeId","data-v-e6a17a7f"]]),ge=""+new URL("bell-notification-79064171.mp3",import.meta.url).href,he={class:"gameContainer"},be={key:0,class:"infoAboutPlayers"},Ue={key:0,class:"containerApproveButtons"},Te=B({__name:"TheGame",props:{header:{},currentUser:{}},setup(b){const n=b,u=H(),{colors:d}=V("indicatorNavi"),y=r("Accept"),T=r("Cancel"),S=r("Redirect for a few sec..."),w=r("Approval game: "),_=X(),{duel:a}=q(_),e=$(A,"users"),s=$(A,"gameStatus"),v=h(s,"Duel"),G=$(A,"gameDuel");h(G,"table1");const I=r(new Audio(ge)),c=r(new Audio(de)),g=r(pe(function(){u.push("/duel-game")},3*1e3));P(()=>a.value.players,async(t,l)=>{t.length===2&&l.length!==t.length&&I.value.play(),t.length===2&&t.find(C=>C.uid===n.currentUser.uid)&&!t.find(C=>!C.readyToGame)&&await f(v,{isStarted:!0})}),P(()=>a.value.isStarted,async t=>{a.value.isStarted===!1&&await _.deleteGameDuel(),a.value.players.find(l=>l.uid===n.currentUser.uid)&&!a.value.players.find(l=>!l.readyToGame)&&(c.value.play(),g.value())}),ee(async()=>{await _.subFirebaseConnect();const t=await K(v);if(t.exists()){const l=t.data().players;t.data().isStarted===!1&&await _.deleteGameDuel(),l.find(k=>k.uid===n.currentUser.uid)&&!l.find(k=>!k.readyToGame)&&(c.value.play(),g.value())}}),ae(async()=>{_.unSubFirebaseConnect(),g.value.cancel()});async function R(){if(a.value.players.find(t=>t.uid===n.currentUser.uid)){await f(h(e,n.currentUser.uid),{game:"",readyToGame:!1,online:"online",timestamp:O()});const t=a.value.players.filter(l=>l.uid!==n.currentUser.uid?l:null);await f(v,{players:t})}else await f(h(e,n.currentUser.uid),{game:"Duel",readyToGame:!1,online:"online",timestamp:O()}),await f(v,{players:te({...n.currentUser,game:"Duel",readyToGame:!1})})}async function j(){if(a.value.players.length===2&&a.value.players.find(t=>t.uid===n.currentUser.uid)){await f(h(e,n.currentUser.uid),{readyToGame:!0});const t=a.value.players.map(l=>l.uid===n.currentUser.uid?{...l,readyToGame:!0}:{...l});await f(v,{players:t})}}async function J(){if(a.value.players.length===2&&a.value.players.find(t=>t.uid===n.currentUser.uid)){a.value.players.forEach(async({uid:l})=>{l===n.currentUser.uid?await f(h(e,l),{game:"",readyToGame:!1}):await f(h(e,l),{readyToGame:!1})});const t=a.value.players.filter(l=>l.uid!==n.currentUser.uid?l:null).map(l=>({...l,readyToGame:!1}));await f(v,{players:t})}}return(t,l)=>{var k;const C=se("ion-icon");return m(),U("section",he,[p(a).players.length===2&&p(a).players.find(F=>F.uid===t.currentUser.uid)?(m(),U("div",be,[o("p",null,i(p(a).isStarted?S.value:w.value+"Duel"),1),o("div",null,[o("p",null,i(p(a).players[0].displayName||p(a).players[0].email)+i(": "),1),p(a).players[0].readyToGame?(m(),x(C,{key:1,class:"animateHand",name:"thumbs-up-sharp",style:"margin-left: 10px;"})):(m(),x(M,{key:0,small:"",style:"margin-left: 10px;"}))]),o("div",null,[o("p",null,i(p(a).players[1].displayName||p(a).players[1].email)+i(": "),1),p(a).players[1].readyToGame?(m(),x(C,{key:1,class:"animateHand",name:"thumbs-up-sharp",style:"margin-left: 10px;"})):(m(),x(M,{key:0,small:"",style:"margin-left: 10px;"}))]),(k=p(a).players.find(F=>F.uid===t.currentUser.uid))!=null&&k.readyToGame?L("",!0):(m(),U("div",Ue,[o("button",{onClick:j},i(y.value),1),o("button",{onClick:J},i(T.value),1)]))])):L("",!0),N(z,{header:"Duel",currentUser:t.currentUser,desc:"A board game inspired by a strategy game called '7 Wonders of the World'",video:"Video soon!",color:p(d)[0],"route-to":"/duel-game","max-players":2,onClickLobby:R,onClickAccept:j,onClickCancel:J},null,8,["currentUser","color"]),N(z,{header:"Gems",currentUser:t.currentUser,desc:"A board game inspired by a strategy game called 'Splendor'",video:"Video soon!",color:p(d)[1],"route-to":"/gems-game","max-players":0},null,8,["currentUser","color"]),N(z,{header:"Reflex",currentUser:t.currentUser,desc:"Game written from 0 in canvasJS. Cooperation against zombies",video:"Video soon!",color:p(d)[2],"route-to":"/reflex-game","max-players":0},null,8,["currentUser","desc","color"])])}}});const Ge=D(Te,[["__scopeId","data-v-4a8f4e5c"]]),Ce=B({__name:"TheSettings",props:{header:{}},setup(b){const n=b,u=r(!1);let d;return W(()=>{d=Q(),le(d,y=>{y?u.value=!0:u.value=!1})}),(y,T)=>(m(),U("h2",null,i(n.header),1))}});const xe=D(Ce,[["__scopeId","data-v-9a33a386"]]),Se=B({__name:"TheLogout",props:{header:{}},setup(b){const n=b,u=H();let d;W(()=>{d=Q()});const y=()=>{re(d).then(()=>{u.push("/")})};return(T,S)=>(m(),U(ne,null,[o("h2",null,i(n.header),1),o("button",{class:E("customButton"),onClick:y},"log out")],64))}});const ke=D(Se,[["__scopeId","data-v-4b372c8a"]]),Le={class:"header"},we={class:"wrapper"},Pe=B({__name:"FeedPanel",setup(b){const n=r("Feed Panel"),u=r("Games"),d=r("Settings"),y=r("log Out"),T=r("game-controller-outline"),S=r("settings-outline"),w=r("log-out-outline"),_=H(),a=$(A,"users"),e=r({}),s=r(u.value),v=r([{name:`${u.value}`,ionIconClass:T.value,to:"/feed/games"},{name:`${d.value}`,ionIconClass:S.value,to:"/feed/settings"},{name:`${y.value}`,ionIconClass:w.value,to:"/feed/logout"}]),G=c=>s.value=c,I=r(["--clr:#2196f3;","--clr:#008a1b;","--clr:#dc1dff;","--clr:#f3218b;","--clr:#d56f1d;"]);return oe("indicatorNavi",{activeLink:s,routes:v,updateActiveLink:G,colors:I}),W(async()=>{await ue().then(async c=>{e.value={uid:c.uid,email:c.email||"",displayName:c.displayName||""};const g=await K(h(a,c.uid));if(g.exists())e.value=g.data();else{const R={uid:c.uid,email:c.email||"",displayName:c.displayName||"",game:"",readyToGame:!1,online:"online",timestamp:O()};e.value=R,await ie(h(a,c.uid),{...R})}}),v.value.find(({name:c,to:g})=>g===_.currentRoute.value.path?(s.value=c,!0):!1)}),(c,g)=>(m(),U("main",null,[o("header",Le,[o("h1",null,i(n.value),1)]),o("section",we,[s.value===u.value?(m(),x(Ge,{key:0,header:u.value,currentUser:e.value},null,8,["header","currentUser"])):L("",!0),s.value===d.value?(m(),x(xe,{key:1,header:d.value,currentUser:e.value},null,8,["header","currentUser"])):L("",!0),s.value===y.value?(m(),x(ke,{key:2,header:y.value,currentUser:e.value},null,8,["header","currentUser"])):L("",!0)]),N(ce)]))}});const Re=D(Pe,[["__scopeId","data-v-945f1108"]]);export{Re as default};
