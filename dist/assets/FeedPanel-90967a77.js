import{d as D,r as n,g as q,s as K,t as Y,w as P,c as U,a as o,b as i,n as E,u as m,e as w,f as Z,o as p,_ as B,h as j,i as V,j as $,k as A,l as b,m as ee,p as Q,q as ae,v as se,x as S,y as N,z as f,A as O,B as te,C as H,D as X,E as le,F as re,G as ne,H as oe,I as ue,J as ie,K as ce}from"./index-be61c0c6.js";import{b as de,d as me,L as M}from"./debounce-e6821605.js";const pe={class:"box"},ye={class:"box"},ve=["disabled"],fe={class:"circle"},he=D({__name:"TheCardComponent",props:{header:{},currentUser:{},video:{},desc:{},color:{},routeTo:{},maxPlayers:{}},emits:["click-lobby"],setup(_,{emit:r}){const u=_,d=n("Go to Lobby"),y=n("Exit Lobby"),G=q(),{duel:k,gems:L,reflex:h}=K(G),{currentUser:a}=Y(u),s=n({id:u.header,status:"Free",players:[]});return P(()=>k.value.players,e=>{s.value.id==="Duel"&&(s.value.players=e,e.length===0?s.value.status="Free":e.length===u.maxPlayers?s.value.status="Busy":s.value.status="Lobby")}),P(()=>L.value.players,e=>{s.value.id==="Gems"&&(s.value.players=e,e.length===0?s.value.status="Free":e.length===u.maxPlayers?s.value.status="Busy":s.value.status="Lobby")}),P(()=>h.value.players,e=>{s.value.id==="Reflex"&&(s.value.players=e,e.length===0?s.value.status="Free":e.length===u.maxPlayers?s.value.status="Busy":s.value.status="Lobby")}),(e,v)=>(p(),U("div",{class:E(["card"]),style:Z(`${e.color}`)},[o("div",pe,i(e.video),1),o("div",ye,[o("h2",null,i(s.value.id),1),o("p",null,i(e.desc),1),s.value.players.length<u.maxPlayers||e.maxPlayers===0?(p(),U("button",{key:0,disabled:e.maxPlayers===0,class:E(["cardButton",s.value.players.find(T=>T.uid===m(a).uid)?"cardButtonLobby":""]),onClick:v[0]||(v[0]=()=>r("click-lobby"))},i(e.maxPlayers===0?"Soon":s.value.players.find(T=>T.uid===m(a).uid)?y.value:d.value),11,ve)):w("",!0)]),o("div",fe,[o("h2",null,i(u.header),1),o("p",null,i(e.maxPlayers===0?"-":s.value.status),1),o("p",null,i(e.maxPlayers===0?"-":`${s.value.players.length}/${e.maxPlayers}`),1)])],4))}}),z=B(he,[["__scopeId","data-v-49c7c014"]]),ge="/vue-project/assets/bell-notification-79064171.mp3",be={class:"gameContainer"},_e={key:0,class:"infoAboutPlayers"},Ue={key:0,class:"containerApproveButtons"},Ge=D({__name:"TheGame",props:{header:{},currentUser:{}},setup(_){const r=_,u=j(),{colors:d}=V("indicatorNavi"),y=n("Accept"),G=n("Cancel"),k=n("Redirect for a few sec to"),L=n("Approval"),h=q(),{duel:a}=K(h),s=$(A,"gameStatus"),e=b(s,"Duel"),v=$(A,"users"),T=$(A,"gameDuel");b(T,"table1");const I=n(new Audio(ge)),c=n(new Audio(de)),g=n(me(function(){u.push("/feed/duel-game")},3*1e3));P(()=>a.value.players,async(t,l)=>{t.length===2&&l.length!==t.length&&I.value.play(),t.length===2&&t.find(C=>C.uid===r.currentUser.uid)&&!t.find(C=>!C.readyToGame)&&await f(e,{isStarted:!0})}),P(()=>a.value.isStarted,async t=>{a.value.isStarted===!1&&await h.deleteGameDuel(),a.value.players.find(l=>l.uid===r.currentUser.uid)&&!a.value.players.find(l=>!l.readyToGame)&&(c.value.play(),g.value())}),ee(async()=>{await h.subFirebaseConnect();const t=await Q(e);if(t.exists()){const l=t.data().players;t.data().isStarted===!1&&await h.deleteGameDuel(),l.find(x=>x.uid===r.currentUser.uid)&&!l.find(x=>!x.readyToGame)&&(c.value.play(),g.value())}}),ae(async()=>{h.unSubFirebaseConnect(),g.value.cancel()});async function R(){if(a.value.players.find(t=>t.uid===r.currentUser.uid)){await f(b(v,r.currentUser.uid),{game:"",readyToGame:!1,online:"online",timestamp:O()});const t=a.value.players.filter(l=>l.uid!==r.currentUser.uid?l:null);await f(e,{players:t})}else await f(b(v,r.currentUser.uid),{game:"Duel",readyToGame:!1,online:"online",timestamp:O()}),await f(e,{players:te({...r.currentUser,game:"Duel",readyToGame:!1})})}async function W(){if(a.value.players.length===2&&a.value.players.find(t=>t.uid===r.currentUser.uid)){await f(b(v,r.currentUser.uid),{readyToGame:!0});const t=a.value.players.map(l=>l.uid===r.currentUser.uid?{...l,readyToGame:!0}:{...l});await f(e,{players:t})}}async function J(){if(a.value.players.length===2&&a.value.players.find(t=>t.uid===r.currentUser.uid)){a.value.players.forEach(async({uid:l})=>{l===r.currentUser.uid?await f(b(v,l),{game:"",readyToGame:!1}):await f(b(v,l),{readyToGame:!1})});const t=a.value.players.filter(l=>l.uid!==r.currentUser.uid?l:null).map(l=>({...l,readyToGame:!1}));await f(e,{players:t})}}return(t,l)=>{var x;const C=se("ion-icon");return p(),U("section",be,[m(a).players.length===2&&m(a).players.find(F=>F.uid===t.currentUser.uid)?(p(),U("div",_e,[o("p",null,i(m(a).isStarted?k.value+": Duel":L.value+": Duel"),1),o("div",null,[o("p",null,i(m(a).players[0].displayName||m(a).players[0].email)+i(": "),1),m(a).players[0].readyToGame?(p(),S(C,{key:1,class:"animateHand",name:"thumbs-up-sharp",style:"margin-left: 10px;"})):(p(),S(M,{key:0,small:"",style:"margin-left: 10px;"}))]),o("div",null,[o("p",null,i(m(a).players[1].displayName||m(a).players[1].email)+i(": "),1),m(a).players[1].readyToGame?(p(),S(C,{key:1,class:"animateHand",name:"thumbs-up-sharp",style:"margin-left: 10px;"})):(p(),S(M,{key:0,small:"",style:"margin-left: 10px;"}))]),(x=m(a).players.find(F=>F.uid===t.currentUser.uid))!=null&&x.readyToGame?w("",!0):(p(),U("div",Ue,[o("button",{onClick:W},i(y.value),1),o("button",{onClick:J},i(G.value),1)]))])):w("",!0),N(z,{header:"Duel",currentUser:t.currentUser,desc:"A board game inspired by a strategy game called '7 Wonders of the World'",video:"Video soon!",color:m(d)[0],"route-to":"/feed/duel-game","max-players":2,onClickLobby:R,onClickAccept:W,onClickCancel:J},null,8,["currentUser","color"]),N(z,{header:"Gems",currentUser:t.currentUser,desc:"A board game inspired by a strategy game called 'Splendor'",video:"Video soon!",color:m(d)[1],"route-to":"/feed/splendor-game","max-players":0},null,8,["currentUser","color"]),N(z,{header:"Reflex",currentUser:t.currentUser,desc:"Game written from 0 in canvasJS. Cooperation against zombies",video:"Video soon!",color:m(d)[2],"route-to":"/feed/reflex-game","max-players":0},null,8,["currentUser","desc","color"])])}}}),Te=B(Ge,[["__scopeId","data-v-4ad96129"]]),Ce=D({__name:"TheSettings",props:{header:{}},setup(_){const r=_,u=n(!1);let d;return H(()=>{d=X(),le(d,y=>{y?u.value=!0:u.value=!1})}),(y,G)=>(p(),U("h2",null,i(r.header),1))}}),Se=B(Ce,[["__scopeId","data-v-9a33a386"]]),ke=D({__name:"TheLogout",props:{header:{}},setup(_){const r=_,u=j();let d;H(()=>{d=X()});const y=()=>{ne(d).then(()=>{u.push("/")})};return(G,k)=>(p(),U(re,null,[o("h2",null,i(r.header),1),o("button",{class:E("customButton"),onClick:y},"log out")],64))}}),xe=B(ke,[["__scopeId","data-v-4b372c8a"]]),we={class:"header"},Le={class:"wrapper"},Pe=D({__name:"FeedPanel",setup(_){const r=n("Feed Panel"),u=n("Games"),d=n("Settings"),y=n("log Out"),G=n("game-controller-outline"),k=n("settings-outline"),L=n("log-out-outline"),h=j(),a=$(A,"users"),s=n({}),e=n(u.value),v=n([{name:`${u.value}`,ionIconClass:G.value,to:"/feed/games"},{name:`${d.value}`,ionIconClass:k.value,to:"/feed/settings"},{name:`${y.value}`,ionIconClass:L.value,to:"/feed/logout"}]),T=c=>e.value=c,I=n(["--clr:#2196f3;","--clr:#008a1b;","--clr:#dc1dff;","--clr:#f3218b;","--clr:#d56f1d;"]);return oe("indicatorNavi",{activeLink:e,routes:v,updateActiveLink:T,colors:I}),H(async()=>{await ue().then(async c=>{s.value={uid:c.uid,email:c.email||"",displayName:c.displayName||""};const g=await Q(b(a,c.uid));if(g.exists())s.value=g.data();else{const R={uid:c.uid,email:c.email||"",displayName:c.displayName||"",game:"",readyToGame:!1,online:"online",timestamp:O()};s.value=R,await ie(b(a,c.uid),{...R})}}),v.value.find(({name:c,to:g})=>g===h.currentRoute.value.path?(e.value=c,!0):!1)}),(c,g)=>(p(),U("main",null,[o("header",we,[o("h1",null,i(r.value),1)]),o("section",Le,[e.value===u.value?(p(),S(Te,{key:0,header:u.value,currentUser:s.value},null,8,["header","currentUser"])):w("",!0),e.value===d.value?(p(),S(Se,{key:1,header:d.value,currentUser:s.value},null,8,["header","currentUser"])):w("",!0),e.value===y.value?(p(),S(xe,{key:2,header:y.value,currentUser:s.value},null,8,["header","currentUser"])):w("",!0)]),N(ce)]))}}),Re=B(Pe,[["__scopeId","data-v-5fe8a4ef"]]);export{Re as default};
